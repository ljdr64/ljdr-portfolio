<header class="fixed top-0 left-0 w-full z-50">
  <nav
    class="min-w-[320px] flex justify-between items-center px-6 py-4
            bg-white/60 dark:bg-gray-900/60 backdrop-blur-md shadow-md fixed top-0 left-0 w-full z-50"
  >
    <a
      href="#"
      class="px-3 py-1 rounded-lg bg-gradient-to-r from-blue-600 to-blue-400
         text-white font-extrabold text-xl shadow-md hover:shadow-lg transition"
    >
      LJDR
    </a>

    <ul class="hidden md:flex gap-6 font-medium">
      <li>
        <a
          href="#projects"
          class="transition-colors dark:text-white hover:text-blue-600 dark:hover:text-blue-400"
        >
          Proyectos
        </a>
      </li>
      <li>
        <a
          href="#skills"
          class="transition-colors dark:text-white hover:text-blue-600 dark:hover:text-blue-400"
        >
          Stack
        </a>
      </li>
      <li>
        <a
          href="#about"
          class="transition-colors dark:text-white hover:text-blue-600 dark:hover:text-blue-400"
        >
          Sobre mí
        </a>
      </li>
      <li>
        <a
          href="#experience"
          class="transition-colors dark:text-white hover:text-blue-600 dark:hover:text-blue-400"
        >
          Experiencia
        </a>
      </li>
      <li>
        <a
          href="#contact"
          class="transition-colors dark:text-white hover:text-blue-600 dark:hover:text-blue-400"
        >
          Contacto
        </a>
      </li>
    </ul>

    <div class="flex items-center gap-4">
      <button
        id="toggleThemeBtn"
        class="w-10 h-10 rounded-xl shadow bg-white dark:bg-black/70 cursor-pointer"
        aria-label="Toggle dark mode"
      >
        <span id="theme-icon">☀️</span>
      </button>

      <button
        id="menuBtn"
        class="md:hidden w-10 h-10 rounded-lg bg-white dark:bg-black/70 dark:text-white cursor-pointer"
      >
        ☰
      </button>
    </div>
  </nav>

  <button
    id="menuBtn"
    class="md:hidden p-2 rounded-lg bg-white dark:bg-black/70 dark:text-white"
    aria-controls="mobileMenu"
    aria-expanded="false"
    aria-label="Abrir menú"
  >
    ☰
  </button>

  <div
    id="mobileMenu"
    class="hidden fixed inset-0 bg-black/60 backdrop-blur-sm z-[60] md:hidden"
    role="dialog"
    aria-modal="true"
    aria-hidden="true"
  >
    <div
      data-panel
      class="relative bg-white dark:bg-gray-900 w-72 max-w-[85%] h-full p-6 font-medium flex flex-col gap-6
         -translate-x-full transition-transform duration-300"
    >
      <div
        class="flex items-center justify-between pb-4 border-b border-gray-200 dark:border-gray-700"
      >
        <h2 class="text-lg font-bold text-gray-800 dark:text-gray-200">Menú</h2>
        <button
          id="closeMenu"
          class="h-10 w-10 rounded-lg hover:bg-black/5 dark:hover:bg-white/10 cursor-pointer"
          aria-label="Cerrar menú"
        >
          ✕
        </button>
      </div>

      <a
        href="#projects"
        class="transition-colors dark:text-white hover:text-blue-600 dark:hover:text-blue-400"
        >Proyectos</a
      >
      <a
        href="#skills"
        class="transition-colors dark:text-white hover:text-blue-600 dark:hover:text-blue-400"
        >Stack</a
      >
      <a
        href="#about"
        class="transition-colors dark:text-white hover:text-blue-600 dark:hover:text-blue-400"
        >Sobre mí</a
      >
      <a
        href="#experience"
        class="transition-colors dark:text-white hover:text-blue-600 dark:hover:text-blue-400"
        >Experiencia</a
      >
      <a
        href="#contact"
        class="transition-colors dark:text-white hover:text-blue-600 dark:hover:text-blue-400"
        >Contacto</a
      >
    </div>
  </div>
</header>

<script>
  const btn = document.getElementById("menuBtn");
  const overlay = document.getElementById("mobileMenu");
  const panel = overlay?.querySelector("[data-panel]");
  const closeBtn = document.getElementById("closeMenu");
  const scrollTopBtn = document.getElementById("scrollTopBtn");

  if (btn && overlay && panel) {
    const openMenu = () => {
      overlay.classList.remove("hidden");
      overlay.setAttribute("aria-hidden", "false");
      requestAnimationFrame(() => {
        panel.classList.remove("-translate-x-full");
        panel.classList.add("translate-x-0");
      });
      document.body.classList.add("overflow-hidden");

      scrollTopBtn?.classList.replace("flex", "hidden");
    };

    const closeMenu = () => {
      btn.focus();
      panel.classList.add("-translate-x-full");
      panel.classList.remove("translate-x-0");
      document.body.classList.remove("overflow-hidden");
      overlay.setAttribute("aria-hidden", "true");

      const onEnd = (e: any) => {
        if (e.propertyName === "translate") {
          overlay.classList.add("hidden");
          panel.removeEventListener("transitionend", onEnd);
        }
      };
      panel.addEventListener("transitionend", onEnd);
    };

    btn.addEventListener("click", openMenu);
    closeBtn?.addEventListener("click", closeMenu);

    overlay.addEventListener("click", (e) => {
      if (e.target === overlay) closeMenu();
    });

    overlay.querySelectorAll("a").forEach((a) => {
      a.addEventListener("click", closeMenu);
    });

    document.addEventListener("keydown", (e) => {
      if (e.key === "Escape") closeMenu();
    });
  }
</script>
